<!DOCTYPE html>
<html>
<head>
	<link rel="stylesheet" href="https://unpkg.com/leaflet@1.7.1/dist/leaflet.css"/>
	<style type="text/css">
		html { height: 100% }
		body { height: 100%; margin: 0; padding: 0;}
		#map { height: 90% }
	</style>
	<script src="https://unpkg.com/leaflet@1.7.1/dist/leaflet.js"></script>
	<script src="./Leaflet.ImageOverlay.Rotated.js"></script>


</head>
<body>
   <div id="map"></div>
   <div>
		<button onclick='changeFloor(1)'>+</button>
		<button onclick='changeFloor(-1)'>-</button>
   </div>
	<script>
		var mymap = L.map('map').setView([46.194927185965064, 6.139895360858279], 20);
		L.tileLayer('https://api.mapbox.com/styles/v1/{id}/tiles/{z}/{x}/{y}?access_token={accessToken}', {
		    attribution: 'Map data &copy; <a href="https://www.openstreetmap.org/copyright">OpenStreetMap</a> contributors, Imagery Â© <a href="https://www.mapbox.com/">Mapbox</a>',
		    maxZoom: 30,
		    id: 'mapbox/streets-v11',
		    tileSize: 512,
		    zoomOffset: -1,
		    accessToken: 'pk.eyJ1IjoiY29pbG0iLCJhIjoiY2t3Zzh6ejllMG05cjJvbWp1czZwd2d5NSJ9.yZexSLCkOBQwDR5xD5aLIg'
		}).addTo(mymap);
		var p1 = L.latLng(46.19485999832131, 6.138750314712524);
		var p2 = L.latLng(46.19580687978871, 6.1397695541381845);
		var p3 = L.latLng(46.194210168266004, 6.140005588531495);
		var img_link = ['./plan-1-01_App copie_page-0001.jpg', './plan-2-01_App copie_page-0001.jpg'];
		var bookFloor = 0;
		var currentFloor = bookFloor;
		
		var overlay = L.imageOverlay.rotated(img_link[currentFloor], p1, p2, p3, {
			opacity: 0.7,
			interactive: false,
			attribution: "UniMail"
		});
		
		mymap.addLayer(overlay);

		function onLocationFound(e){
			var radius = e.accuracy;

			L.marker(e.latlng).addTo(mymap);
			L.circle(e.latlng, radius).addTo(mymap);
		}

		function onLocationError(e){
			alert(e.message);
		}

		mymap.locate();

		mymap.on('locationfound', onLocationFound);
		mymap.on('locationerror', onLocationError);



		function changeFloor(step) {

			if (currentFloor + step < 0){
				currentFloor = 0;
			}
			else if (currentFloor + step > img_link.length - 1){
				currentFloor = img_link.length;
			}
			else{
				currentFloor += step;
				overlay.setUrl(img_link[currentFloor])
/*
				mymap.removeLayer(overlay);

				overlay = L.imageOverlay.rotated(img_link[currentFloor], p1, p2, p3, {
						opacity: 0.7,
						interactive: false,
						attribution: "UniMail"
					});
		
				mymap.addLayer(overlay);
*/
			}
				

			// update image
			
		}
			
	</script>
</body>
</html>